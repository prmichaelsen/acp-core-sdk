# package.yaml
name: core-sdk
version: 1.8.0
description: Patterns and templates for creating reusable core libraries that can be shared across MCP servers, REST APIs, and client applications
author: Patrick Michaelsen
license: MIT
homepage: https://github.com/prmichaelsen/acp-core-sdk
repository: https://github.com/prmichaelsen/acp-core-sdk.git

# Release configuration
release:
  branch: main

# Package contents
# Add files here as you create them
# Use @acp.pattern-create, @acp.command-create, @acp.design-create
# These commands automatically update this section
contents:
  patterns:
    - name: core-sdk.service-base.md
      description: Base service class pattern with lifecycle management, configuration, and common functionality
      category: Service Layer
      
    - name: core-sdk.service-interface.md
      description: Service interface pattern for dependency injection and loose coupling
      category: Service Layer
      
    - name: core-sdk.service-container.md
      description: Service container pattern for dependency injection and lifecycle management
      category: Service Layer
      
    - name: core-sdk.service-error-handling.md
      description: Consistent error handling pattern with custom error classes and error codes
      category: Service Layer
      
    - name: core-sdk.service-logging.md
      description: Structured logging pattern with consistent format across services
      category: Service Layer
    
    - name: core-sdk.adapter-base.md
      description: Base adapter class pattern with lifecycle management for all deployment targets
      category: Adapter Layer
      
    - name: core-sdk.adapter-mcp.md
      description: MCP adapter pattern for exposing services through Model Context Protocol
      category: Adapter Layer
      
    - name: core-sdk.adapter-rest.md
      description: REST adapter pattern for exposing services through HTTP REST APIs
      category: Adapter Layer
      
    - name: core-sdk.adapter-cli.md
      description: CLI adapter pattern for exposing services through command-line interfaces
      category: Adapter Layer
      
    - name: core-sdk.adapter-client.md
      description: Client adapter pattern for exposing services as a consumable library
      category: Adapter Layer

    - name: core-sdk.config-schema.md
      description: Type-safe configuration schema pattern using Zod with validation and composition
      category: Configuration

    - name: core-sdk.config-environment.md
      description: Environment variable mapping pattern with type coercion and naming conventions
      category: Configuration

    - name: core-sdk.config-loading.md
      description: Layered configuration loading pattern with priority hierarchy and hot reload
      category: Configuration

    - name: core-sdk.config-secrets.md
      description: Secret management pattern with Secret wrapper, vault integration, and rotation
      category: Configuration

    - name: core-sdk.config-multi-env.md
      description: Multi-environment configuration pattern with inheritance for dev/staging/prod
      category: Configuration

    - name: core-sdk.testing-unit.md
      description: Unit testing pattern with Jest, jest.config.js, and colocated .spec.ts files
      category: Testing

    - name: core-sdk.testing-integration.md
      description: Integration testing pattern with .integration.spec.ts naming convention
      category: Testing

    - name: core-sdk.testing-mocks.md
      description: Mocks and stubs pattern with jest.Mocked<T> and colocated mock factories
      category: Testing

    - name: core-sdk.testing-fixtures.md
      description: Test fixtures pattern with colocated .fixtures.ts factory functions
      category: Testing

    - name: core-sdk.testing-coverage.md
      description: Coverage configuration pattern with jest.config.js thresholds and CI enforcement
      category: Testing

    - name: core-sdk.types-shared.md
      description: Shared domain types pattern with branded primitives, DTOs, and pagination shapes
      category: Type System

    - name: core-sdk.types-config.md
      description: Configuration types pattern with Zod-derived types and layer-scoped config slices
      category: Type System

    - name: core-sdk.types-generic.md
      description: Generic utility types pattern with DeepPartial, Nullable, Maybe, and type helpers
      category: Type System

    - name: core-sdk.types-error.md
      description: Error type hierarchy pattern with discriminated unions and HTTP/MCP status mapping
      category: Type System

    - name: core-sdk.types-result.md
      description: Result type pattern for typed functional error handling without exceptions
      category: Type System

  commands: []
  
  designs:
    - name: core-sdk.architecture.md
      description: Patterns and templates for creating reusable core libraries that can be shared across MCP servers, REST APIs, and client applications
  
  # Template source files for core library projects
  # These files are installed into consumer projects via `acp.package-install`
  templates:
    # Configuration files (required for project setup)
    - name: config/package.json.template
      description: npm package configuration with subpath exports
      target: ./
      required: true
      variables:
        - PACKAGE_NAME
        - PACKAGE_DESCRIPTION
        - AUTHOR_NAME

    - name: config/tsconfig.json
      description: TypeScript configuration for ESM modules, strict mode, declarations
      target: ./
      required: true

    - name: config/jest.config.js
      description: Jest configuration for ESM + TypeScript with colocated .spec.ts files
      target: ./
      required: true

    - name: config/esbuild.build.js
      description: esbuild build configuration for multiple entry points
      target: ./
      required: true

    - name: config/esbuild.watch.js
      description: esbuild watch mode for development
      target: ./
      required: true

    - name: config/gitignore.template
      description: Git ignore rules for Node.js projects
      target: ./.gitignore
      required: true

    - name: config/npmignore.template
      description: npm ignore rules to exclude dev files from published package
      target: ./.npmignore
      required: true

    # Type system (core shared types)
    - name: src/types/result.types.ts
      description: Result<T,E> discriminated union with ok/err constructors and combinators
      target: src/types/
      required: false

    - name: src/types/utils.types.ts
      description: Generic utility types — DeepPartial, Nullable, Maybe, Immutable, RequireFields
      target: src/types/
      required: false

    - name: src/types/shared.types.ts
      description: Branded domain types (UserId, EmailAddress), User entity, UserDTO, PaginatedResult
      target: src/types/
      required: false

    - name: src/types/index.ts
      description: Barrel re-export for all type utilities and domain types
      target: src/types/
      required: false

    # Error hierarchy
    - name: src/errors/base.error.ts
      description: AppError abstract base class with ErrorKind discriminant and ErrorContext
      target: src/errors/
      required: false

    - name: src/errors/app-errors.ts
      description: Typed error subclasses for all 8 error kinds (validation, not_found, etc.)
      target: src/errors/
      required: false

    - name: src/errors/index.ts
      description: Barrel re-export with AppErrorUnion, HTTP_STATUS map, and isAppError guard
      target: src/errors/
      required: false

    # Configuration
    - name: src/config/schema.ts
      description: Zod config schemas with inferred types, layer-scoped slices, and test helper
      target: src/config/
      required: false

    - name: src/config/loader.ts
      description: loadConfig — merges env vars over raw config and validates via Zod
      target: src/config/
      required: false

    - name: src/config/index.ts
      description: Barrel re-export for all config schemas, types, and helpers
      target: src/config/
      required: false

    # Service layer
    - name: src/services/base.service.ts
      description: BaseService abstract class with config/logger injection and lifecycle hooks
      target: src/services/
      required: false

    - name: src/services/user.service.ts
      description: UserService example using Result<T,E>, typed errors, and UserRepository interface
      target: src/services/
      required: false

    - name: src/services/index.ts
      description: Barrel re-export for all service classes and interfaces
      target: src/services/
      required: false

    # REST client (installable — wraps all REST endpoints as typed functions)
    - name: src/client/user.client.ts
      description: Typed REST client wrapping all user endpoints — createUserClient(baseUrl)
      target: src/client/
      required: false

    - name: src/client/index.ts
      description: Barrel re-export for the REST client
      target: src/client/
      required: false

    # Examples (installed to ./examples/, not src/ — reference implementations)
    - name: examples/rest/server.ts
      description: Express REST server wiring UserService to routes
      target: examples/rest/
      required: false

    - name: examples/rest/user.routes.ts
      description: Express route handlers calling UserService with Result<T,E>
      target: examples/rest/
      required: false

    - name: examples/rest/error-handler.ts
      description: Centralized Express error handler using HTTP_STATUS map
      target: examples/rest/
      required: false

    - name: examples/rest/client-usage.ts
      description: Runnable script showing UserClient against the REST server
      target: examples/rest/
      required: false

    - name: examples/mcp/server.ts
      description: MCP server setup wiring UserService to MCP tools
      target: examples/mcp/
      required: false

    - name: examples/mcp/user.tools.ts
      description: MCP tool definitions wrapping UserService methods
      target: examples/mcp/
      required: false

    - name: examples/cli/program.ts
      description: Commander program setup wiring UserService to CLI commands
      target: examples/cli/
      required: false

    - name: examples/cli/user.commands.ts
      description: Commander command definitions wrapping UserService methods
      target: examples/cli/
      required: false

    # Test utilities for examples
    - name: examples/test/user.repository.mock.ts
      description: In-memory UserRepository for integration tests (no real database)
      target: examples/test/
      required: false

# Compatibility
requires:
  acp: >=2.8.0

# Tags for discovery
tags:
  - core-library
  - sdk
  - typescript
  - npm-package
  - mcp
  - rest-api
  - reusable-code
